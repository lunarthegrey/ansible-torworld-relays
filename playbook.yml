---
- name: Update the configuration of Tor World relays
  hosts: torworld-relays
  remote_user: root

  tasks:
  - name: Update MyFamily
    lineinfile:
      dest: /etc/tor/torrc
      regexp: "{{item.regexp}}"
      line: "{{item.line}}"
      state: present

    with_items:
      - regexp: "^#?MyFamily"
        line: "MyFamily 88C3708A9D71ECEC1910B63C3FAA5BF60CD7E199,157106182B9F33663CAEDCD883D302316331DE5E,B756D7123D759EAB62CB6A09148AD65AC216F3E3,3844DFD3446832A3C8A137EEA616D4EEB370C788,CE946DFEC40A1BFC3665A4727F54354F57297497,C79517FFC1327B0D4E86218A34C8E2570F338CF9,8C34A154997812D1396BC462A42DA0A59B55952D,AEA760EE120B630262C70C1C11D4158BBF12C602,C8850DE0EBC07481808F32F2BAA76CA65CB659FB,8154154C636EC317C7165FD839F34F79963376C1,42E0FB190D20522C6C8C71E42B71DA33AC7A780E"

  - name: Reload Tor
    service: name=tor state=reloaded enabled=yes
